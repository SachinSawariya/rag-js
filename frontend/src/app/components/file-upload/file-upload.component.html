<div class="upload-container">
  <div class="upload-card">
    <h1 class="title">Upload Your Document</h1>
    <p class="subtitle">Upload a text file to start chatting with your RAG assistant</p>

    <div
      class="drop-zone"
      [class.dragging]="isDragging"
      [class.has-file]="selectedFile"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      @if (!selectedFile) {
      <div class="drop-zone-content">
        <svg
          class="upload-icon"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
          />
        </svg>
        <p class="drop-text">Drag and drop your .txt file here</p>
        <p class="or-text">or</p>
        <label class="file-input-label">
          <input type="file" accept=".txt" (change)="onFileSelected($event)" class="file-input" />
          <span class="browse-button">Browse Files</span>
        </label>
      </div>
      }

      @if (selectedFile && !uploadSuccess) {
      <div class="file-info">
        <svg
          class="file-icon"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        <div class="file-details">
          <p class="file-name">{{ selectedFile.name }}</p>
          <p class="file-size">{{ getFileSize() }}</p>
        </div>
        <button class="remove-button" (click)="resetUpload()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>
      }
    </div>

    @if (errorMessage) {
    <div class="error-message">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      {{ errorMessage }}
    </div>
    }

    @if (uploadSuccess) {
    <div class="success-message">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      File uploaded successfully! The document is being processed.
    </div>
    }

    <div class="actions">
      @if (isUploading) {
      <div class="progress-container">
        <div class="progress-info">
          <span class="progress-stage">{{ progressStage }}...</span>
          <span class="progress-percent">{{ progressPercentage }}%</span>
        </div>
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" [style.width.%]="progressPercentage"></div>
        </div>
        <p class="status-message">{{ progressMessage }}</p>
      </div>
      } 
      
      @if (!isUploading && selectedFile && !uploadSuccess) {
      <button class="upload-button" (click)="uploadFile()">
        <span>Upload File</span>
      </button>
      }

      @if (uploadSuccess) {
      <div class="success-message">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 13l4 4L19 7"
          />
        </svg>
        <span>Upload complete! Redirecting to chat...</span>
      </div>
      }
    </div>
  </div>
</div>
